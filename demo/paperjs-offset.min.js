!function(w){"use strict";var y,u,n;function e(n,t,e){var r=function(e,r,i,o){var n=e.unite(e,{insert:!1}),t=n;if(n instanceof w.Path)t=u.OffsetSimpleShape(n,r,i,o);else{var a=y.Flat(n.children.map(function(n){if(1<n.segments.length){u.IsSameDirection(n,e)||n.reverse();var t=u.OffsetSimpleShape(n,r,i,o);return(t=u.Normalize(t)).clockwise!==n.clockwise&&t.reverse(),t instanceof w.CompoundPath?(t.applyMatrix=!0,t.children):t}return null}),!1);t=new w.CompoundPath({children:a,insert:!1})}return t.copyAttributes(n,!1),t}(n,t,(e=e||{}).join||"miter",e.limit||10);return void 0===e.insert&&(e.insert=!0),e.insert&&(n.parent||w.project.activeLayer).addChild(r),r}function r(n,t,e){var r=function(n,t,e,r,i){var o=n.unite(n,{insert:!1}),a=o;return(a=o instanceof w.Path?u.OffsetSimpleStroke(o,t,e,r,i):y.Flat(o.children.map(function(n){return u.OffsetSimpleStroke(n,t,e,r,i)})).reduce(function(n,t){return n.unite(t,{insert:!1})})).strokeWidth=0,a.fillColor=o.strokeColor,a.shadowBlur=o.shadowBlur,a.shadowColor=o.shadowColor,a.shadowOffset=o.shadowOffset,a}(n,t,(e=e||{}).join||"miter",e.cap||"butt",e.limit||10);return void 0===e.insert&&(e.insert=!0),e.insert&&(n.parent||w.project.activeLayer).addChild(r),r}w=w&&w.hasOwnProperty("default")?w.default:w,function(n){function r(n,r,t){if(void 0===t&&(t=!1),t){var e="function"==typeof r?function(n,t,e){return!r(n,t,e)}:function(n){return n!==r},i=n.filter(e);if(i.length<n.length)return n.splice.apply(n,[0,n.length].concat(i)),!0}else{var o="function"==typeof r?n.findIndex(r):n.indexOf(r);if(-1<o)return n.splice(o,1),!0}return!1}function c(e,r){return 0<e?new Array(e).fill(null).map(function(n,t){return r(t,e)}):[]}n.Delete=r,n.BatchDelete=function(t,n,e){void 0===e&&(e=!1),n.forEach(function(n){r(t,n,e)})},n.Replace=function(n,t,e,r){if(void 0===r&&(r=!1),null==n)return!1;var i=!1;do{var o="function"==typeof t?n.findIndex(t):n.indexOf(t);if(!(-1<o))break;n[o]=e,i=!0}while(r);return i},n.Find=function(n,t){var e=n.findIndex(t);return n[e]},n.IncludeSome=function(t,n){return n.some(function(n){return t.includes(n)})},n.OrderedInsert=function(n,t,e,r){void 0===r&&(r=!1);var i=n.findIndex(function(n){return 0<=e(n,t)});if(-1<i){var o=0===e(n[i],t);return n.splice(i,o&&r?1:0,t),i}return n.push(t),n.length-1},n.InsertBefore=function(n,t,e){var r=n.indexOf(e);n.splice(Math.max(r,0),0,t)},n.InsertAfter=function(n,t,e){var r=n.indexOf(e);-1<r?n.splice(r+1,0,t):n.push(e)},n.ApproximateIndex=function(n,t,e){return void 0===e&&(e=0),n.findIndex(function(n){return Math.abs(n-t)<=e})},n.Approximate=function(n,t,e){void 0===e&&(e=0);var r=n.findIndex(function(n){return Math.abs(n-t)<=e});return n[r]},n.Empty=function(n){return 0<n?new Array(n).fill(null):[]},n.Create=c,n.Repeat=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return c(t*e.length,function(n){return e[Math.floor(n/t)]})},n.RepeatSequence=function(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return c(n*t.length,function(n){return t[n%t.length]})},n.AnalyzePeriod=function(n){for(var t=Math.ceil(Math.sqrt(n.length)),e=1;e<=t;++e)if(n.length%e==0){for(var r=n.slice(0,e),i=!0,o=e;o<n.length;++o)if(n[o]!==r[o%e]){i=!1;break}if(i)return r}return n},n.Flat=function(n,t){void 0===t&&(t=!1);var e=Array.prototype.concat.apply([],n);return t?e:e.filter(function(n){return null!=n})},n.Divide=function(n,t){for(var e=[],r=0;r<n.length;r+=t)e.push(n.slice(r,r+t));return e},n.Group=function(r,i){var o={};return r.forEach(function(n,t){var e=i(n,t,r);o[e]||(o[e]=[]),o[e].push(n)}),o},n.Sample=function(t,n,e){if(void 0===e&&(e=!1),n>=t.length)return t;if(e){for(var r=[],i=t.slice(),o=0;o<n;++o){var a=i.splice(Math.round(i.length*Math.random()),1)[0];r.push(a)}return r}var u=t.length/n;return c(n,function(n){return t[Math.round(u*n)]})},n.Union=function(n,t){void 0===t&&(t=!1);var e=Array.prototype.concat.apply([],n);return t?Array.from(new Set(e)):e},n.Intersect=function(e){if(1<e.length){var t=new Map;e[0].forEach(function(n){return t.set(n,1)});for(var n=1;n<e.length;++n)e[n].forEach(function(n){t.has(n)&&t.set(n,t.get(n)+1)});var r=new Array;return t.forEach(function(n,t){n===e.length&&r.push(t)}),r}return e[0]||[]},n.Subtract=function(n,t){if(1<t.length){var e=new Set(Array.prototype.concat.apply([],t));return n.filter(function(n){return!e.has(n)})}return n||[]},n.NonNull=function(n){return n.filter(function(n){return null!=n})}}(y||(y={})),function(n){function f(n,t,e,r){var i=n.curve===t,o=t.getNormalAt(i?0:1,!0).multiply(r),a=n.point.add(o),u=new w.Segment(a),c=i?"handleOut":"handleIn";return u[c]=n[c].add(e.subtract(o).divide(2)),u}function v(n,t){return n.x*t.y-n.y*t.x}function l(n,t,e,r,i,o){var a=new w.Curve(n[0],n[1]),u=new w.Curve(t[0],t[1]),c=a.getIntersections(u),s=n[1].point.getDistance(t[0].point);if(e.isSmooth())t[0].handleOut=t[0].handleOut.project(e.handleOut),t[0].handleIn=n[1].handleIn.project(e.handleIn),t[0].point=n[1].point.add(t[0].point).divide(2),n.pop();else if(0===c.length)if(s>.1*Math.abs(i))switch(r){case"miter":var f=function(n,t,e,r){var i=n.subtract(t),o=e.subtract(r),a=v(n,t),u=v(e,r);return new w.Point(a*o.x-i.x*u,a*o.y-i.y*u).divide(v(i,o))}(a.point2,a.point2.add(a.getTangentAt(1,!0)),u.point1,u.point1.add(u.getTangentAt(0,!0)));Math.max(f.getDistance(a.point2),f.getDistance(u.point1))<Math.abs(i)*o&&n.push(new w.Segment(f));break;case"round":var l=function(n,t,e,r){var i=n.point.subtract(e).add(t.point.subtract(e)).normalize(Math.abs(r)).add(e),o=new w.Path.Arc({from:n.point,to:t.point,through:i,insert:!1});return n.handleOut=o.firstSegment.handleOut,t.handleIn=o.lastSegment.handleIn,3===o.segments.length?o.segments[1]:null}(n[1],t[0],e.point,i);l&&n.push(l)}else t[0].handleIn=n[1].handleIn,n.pop();else{var h=a.divideAt(c[0]);if(h){var d=h.segment1,p=u.divideAt(u.getIntersections(a)[0]);d.handleOut=p?p.segment1.handleOut:t[0].handleOut,n.pop(),t[0]=d}else t[0].handleIn=n[1].handleIn,n.pop()}}function r(n){return 1===n.children.length&&(n=n.children[0]).remove(),n}function h(n,t){if(void 0===t&&(t=.01),n.closed){var e=Math.abs(n.area*t);if(n.clockwise||n.reverse(),(n=n.unite(n,{insert:!1}))instanceof w.CompoundPath&&(n.children.filter(function(n){return Math.abs(n.area)<e}).forEach(function(n){return n.remove()}),1===n.children.length))return r(n)}return n}function e(n,t){var e=(n.segments[0].location.offset+n.segments[Math.max(1,Math.floor(n.segments.length/2))].location.offset)/3;return t.getNearestLocation(n.getPointAt(e)).offset<t.getNearestLocation(n.getPointAt(2*e)).offset}function d(t){var n=t.unite(t,{insert:!1});return n instanceof w.CompoundPath?(n.children.filter(function(n){return!(1<n.segments.length)||!e(n,t)}).forEach(function(n){return n.remove()}),r(n)):t}function p(n,t){(function(n){return n instanceof w.CompoundPath?y.Flat(n.children.map(function(n){return n.segments})):n.segments})(n).slice().forEach(function(n){t.contains(n.point)||n.remove()})}function m(n,t,e,r){var i,o;o=(i=function(n,t){var e=n.clone({insert:!1});return e.reduce(),n.clockwise||(e.reverse(),t=-t),[e,t]}(n,t))[0],t=i[1];var a=o.curves.slice(),u=y.Divide(y.Flat(a.map(function(n){return function n(t,e){var r=new w.Curve(t.segment1.handleOut.add(t.segment1.point),new w.Point(0,0),new w.Point(0,0),t.segment2.handleIn.add(t.segment2.point)).getNormalAt(.5,!0).multiply(e),i=f(t.segment1,t,r,e),o=f(t.segment2,t,r,e),a=new w.Curve(i,o);if(0===a.getIntersections(a).length){var u=Math.min(Math.abs(e)/10,1),c=a.getPointAt(.5,!0).getDistance(t.getPointAt(.5,!0));if(Math.abs(c-Math.abs(e))>u){var s=t.divideAtTime(.5);if(null!=s)return n(t,e).concat(n(s,e))}}return[i,o]}(n,t)})),2),c=y.Flat(function(n,t,e,r,i){for(var o=e.segments,a=n[0].slice(),u=0;u<n.length-1;++u)l(n[u],n[u+1],o[u+1],t,r,i);return e.closed&&(l(n[n.length-1],a,o[0],t,r,i),n[0][0]=a[0]),n}(u,e,o,t,r)),s=d(new w.Path({segments:c,insert:!1,closed:n.closed}));return s.reduce(),o.closed&&(o.clockwise&&t<0||!o.clockwise&&0<t)&&p(s,n),o.clockwise!==n.clockwise&&s.reverse(),h(s)}function g(n,t,e){var r=n.point.add(t.point).divide(2),i=t.point.subtract(n.point).rotate(-90).normalize(e),o=r.add(i);return new w.Path.Arc({from:n.point,to:t.point,through:o,insert:!1}).segments}n.ConnectAdjacentBezier=l,n.Normalize=h,n.IsSameDirection=e,n.RemoveIntersection=d,n.OffsetSimpleShape=m,n.OffsetSimpleStroke=function(n,t,e,r,i){var o=m(n,t=n.clockwise?t:-t,e,i),a=m(n,-t,e,i);if(n.closed)return o.subtract(a,{insert:!1});var u=a,c=new Array;a instanceof w.CompoundPath&&((c=a.children.filter(function(n){return n.closed})).forEach(function(n){return n.remove()}),u=a.children[0]),u.reverse();var s=function(n,t,e,r){if(n instanceof w.CompoundPath){var i=n.children.map(function(n){return{c:n,a:Math.abs(n.area)}});n=(i=i.sort(function(n,t){return t.a-n.a}))[0].c}var o=n.segments.slice(),a=t.segments.slice();switch(r){case"round":var u=g(a[a.length-1],o[0],e),c=g(o[o.length-1],a[0],e),s=new w.Path({segments:u.concat(o,c,a),closed:!0,insert:!1});return s.reduce(),s;default:return new w.Path({segments:o.concat(a),closed:!0,insert:!1})}}(o,u,t,r);if(0<c.length)for(var f=0,l=c;f<l.length;f++){var h=l[f];s=s.subtract(h,{insert:!1})}return s}}(u||(u={})),(n=w).Path.prototype.offset=function(n,t){return e(this,n,t)},n.Path.prototype.offsetStroke=function(n,t){return r(this,n,t)},n.CompoundPath.prototype.offset=function(n,t){return e(this,n,t)},n.CompoundPath.prototype.offsetStroke=function(n,t){return r(this,n,t)}}(paper);
